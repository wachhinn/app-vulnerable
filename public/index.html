<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üè¶ Sistema Bancario Vulnerable v2.0</title>
    <style>
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            max-width: 1200px; 
            margin: 0 auto; 
            padding: 20px; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
        }
        .container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin: 20px 0;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .vulnerable {
            background: rgba(255, 100, 100, 0.2);
            border-left: 5px solid #ff4757;
            padding: 20px;
            margin: 15px 0;
            border-radius: 10px;
        }
        .vulnerable:hover {
            background: rgba(255, 100, 100, 0.3);
            transform: translateY(-2px);
            transition: all 0.3s ease;
        }
        h1, h2, h3 {
            color: #fff;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        .danger {
            color: #ff6b6b;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }
        .warning {
            background: rgba(255, 165, 0, 0.2);
            border-left: 5px solid #ffa502;
            padding: 15px;
            margin: 15px 0;
            border-radius: 10px;
        }
        input, button {
            padding: 12px 20px;
            margin: 8px 0;
            border: none;
            border-radius: 8px;
            font-size: 16px;
        }
        input {
            width: 70%;
            background: rgba(255, 255, 255, 0.9);
        }
        button {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            color: white;
            cursor: pointer;
            font-weight: bold;
            transition: transform 0.2s;
        }
        button:hover {
            transform: scale(1.05);
        }
        code {
            background: rgba(0, 0, 0, 0.3);
            padding: 4px 8px;
            border-radius: 4px;
            font-family: monospace;
        }
        .result-box {
            background: rgba(0, 0, 0, 0.2);
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            overflow-x: auto;
        }
        .live-demo {
            background: rgba(46, 204, 113, 0.2);
            border-left: 5px solid #2ecc71;
            padding: 20px;
            margin: 15px 0;
            border-radius: 10px;
        }
        footer {
            margin-top: 40px;
            text-align: center;
            font-size: 14px;
            opacity: 0.8;
        }
        .vuln-tag {
            display: inline-block;
            background: #ff4757;
            color: white;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 12px;
            margin: 0 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üè¶ Sistema Bancario "Seguro" v2.0</h1>
        <p class="danger">‚ö†Ô∏è ADVERTENCIA: Esta aplicaci√≥n tiene vulnerabilidades INTENCIONALES para fines educativos del proyecto semestral</p>
        
        <div class="live-demo">
            <h2>üé• DEMOSTRACI√ìN EN VIVO</h2>
            <p>Esta p√°gina se despliega autom√°ticamente con cada cambio en el repositorio.</p>
            <p><strong>Build actual:</strong> <span id="buildNumber">#?</span></p>
            <p><strong>Estado:</strong> <span id="status" style="color:#2ecc71;">‚óè EN L√çNEA</span></p>
        </div>
        
        <div class="vulnerable">
            <h2>üîì <span class="vuln-tag">CR√çTICA</span> XSS (Cross-Site Scripting)</h2>
            <p>Entrada de usuario sin sanitizaci√≥n que permite ejecuci√≥n de c√≥digo JavaScript malicioso.</p>
            <form action="/search" method="GET" target="_blank">
                <input type="text" name="q" placeholder="Buscar usuario..." 
                       value="<script>alert('XSS Exploit')</script>">
                <button type="submit">üîç Probar XSS</button>
            </form>
            <div class="result-box">
                <strong>Ejemplos maliciosos:</strong><br>
                <code>&lt;script&gt;alert('Hacked')&lt;/script&gt;</code><br>
                <code>&lt;img src=x onerror=alert('XSS')&gt;</code><br>
                <code>&lt;svg onload=alert(1)&gt;</code>
            </div>
        </div>
        
        <div class="vulnerable">
            <h2>üîì <span class="vuln-tag">CR√çTICA</span> Credenciales Hardcodeadas</h2>
            <p>Contrase√±as expuestas directamente en el c√≥digo JavaScript.</p>
            <form id="loginForm">
                <input type="text" name="username" placeholder="Usuario" value="admin">
                <input type="password" name="password" placeholder="Contrase√±a" value="admin123">
                <button type="submit">üîë Iniciar Sesi√≥n (Inseguro)</button>
            </form>
            <div id="loginResult" class="result-box"></div>
            <div class="result-box">
                <strong>Credenciales expuestas:</strong><br>
                ‚Ä¢ Usuario: <code>admin</code> | Contrase√±a: <code>admin123</code><br>
                ‚Ä¢ Usuario: <code>user</code> | Contrase√±a: <code>password123</code>
            </div>
        </div>
        
        <div class="vulnerable">
            <h2>üîì <span class="vuln-tag">ALTA</span> Exposici√≥n de Datos Sensibles</h2>
            <p>API sin autenticaci√≥n que expone informaci√≥n confidencial de usuarios.</p>
            <button onclick="fetchUsers()">üìä Mostrar Datos de Usuarios (Sin Auth)</button>
            <button onclick="fetchDebug()">üêõ Mostrar Informaci√≥n de Debug</button>
            <div id="dataResult" class="result-box"></div>
        </div>
        
        <div class="vulnerable">
            <h2>üîì <span class="vuln-tag">MEDIA</span> SQL Injection Simulada</h2>
            <p>Concatenaci√≥n directa de par√°metros en consultas "simuladas".</p>
            <input type="text" id="userId" placeholder="ID de usuario" value="1 OR 1=1">
            <button onclick="simulateSQLi()">üóÉÔ∏è Ejecutar Consulta Vulnerable</button>
            <div id="sqlResult" class="result-box"></div>
        </div>
        
        <div class="warning">
            <h2>üîç AN√ÅLISIS AUTOM√ÅTICO CON SONARQUBE</h2>
            <p>Esta p√°gina es analizada autom√°ticamente por SonarQube con cada cambio.</p>
            <p><strong>Vulnerabilidades que SonarQube detectar√°:</strong></p>
            <ul>
                <li>‚úÖ XSS en formularios de b√∫squeda</li>
                <li>‚úÖ Credenciales hardcodeadas en JavaScript</li>
                <li>‚úÖ Exposici√≥n de datos sin autenticaci√≥n</li>
                <li>‚úÖ Informaci√≥n de debug expuesta</li>
                <li>‚úÖ Secrets en c√≥digo fuente</li>
                <li>‚úÖ CORS demasiado permisivo</li>
            </ul>
        </div>
        
        <script>
            // ====================
            // VULNERABILIDADES INTENCIONALES
            // ====================
            
            // VULNERABLE: Credenciales hardcodeadas en JavaScript
            const HARDCODED_CREDENTIALS = {
                admin: 'admin123',
                user: 'password123',
                guest: 'guest123'
            };
            
            // VULNERABLE: Secrets en cliente
            const API_SECRETS = {
                apiKey: 'sk_live_1234567890abcdef',
                jwtSecret: 'super_secret_jwt_key_123',
                dbPassword: 'root_password_secure_not'
            };
            
            // VULNERABLE: Mostrar informaci√≥n de build
            document.getElementById('buildNumber').textContent = '#' + (Math.floor(Math.random() * 100) + 1);
            
            // ====================
            // FUNCIONES VULNERABLES
            // ====================
            
            // Login inseguro (validaci√≥n en cliente)
            document.getElementById('loginForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const username = this.username.value;
                const password = this.password.value;
                
                // VULNERABLE: Validaci√≥n en cliente
                if (HARDCODED_CREDENTIALS[username] === password) {
                    document.getElementById('loginResult').innerHTML = 
                        `<div style="color:#2ecc71;">
                            ‚úÖ <strong>Login exitoso</strong> como ${username}<br>
                            <small>Token generado: fake_jwt_${Date.now()}</small>
                        </div>`;
                    // VULNERABLE: Almacenar en localStorage sin seguridad
                    localStorage.setItem('userSession', JSON.stringify({
                        user: username,
                        token: 'insecure_token_' + Math.random(),
                        expires: Date.now() + 3600000
                    }));
                } else {
                    document.getElementById('loginResult').innerHTML = 
                        `<div style="color:#ff4757;">
                            ‚ùå Credenciales incorrectas<br>
                            <small>Intenta con: admin/admin123</small>
                        </div>`;
                }
            });
            
            // Exponer datos sensibles
            function fetchUsers() {
                fetch('/api/users')
                    .then(r => r.json())
                    .then(users => {
                        document.getElementById('dataResult').innerHTML = 
                            `<strong>üìã Datos de usuarios (SIN AUTENTICACI√ìN):</strong><br>
                             <pre>${JSON.stringify(users, null, 2)}</pre>
                             <small class="danger">‚ö†Ô∏è ¬°Contrase√±as expuestas!</small>`;
                    })
                    .catch(e => {
                        document.getElementById('dataResult').innerHTML = 
                            `‚ùå Error: ${e.message}<br>
                             <small>El servidor podr√≠a no estar corriendo</small>`;
                    });
            }
            
            function fetchDebug() {
                fetch('/debug')
                    .then(r => r.json())
                    .then(debugInfo => {
                        document.getElementById('dataResult').innerHTML = 
                            `<strong>üêõ Informaci√≥n de Debug (EXPUESTA):</strong><br>
                             <pre>${JSON.stringify(debugInfo, null, 2)}</pre>
                             <small class="danger">‚ö†Ô∏è ¬°Secrets expuestos!</small>`;
                    });
            }
            
            // SQL Injection simulada
            function simulateSQLi() {
                const userId = document.getElementById('userId').value;
                // VULNERABLE: Concatenaci√≥n directa
                const maliciousQuery = `SELECT * FROM usuarios WHERE id = ${userId}`;
                document.getElementById('sqlResult').innerHTML = 
                    `<strong>üóÉÔ∏è Consulta SQL vulnerable:</strong><br>
                     <code>${maliciousQuery}</code><br><br>
                     <strong>üéØ Ejemplos de ataque:</strong><br>
                     ‚Ä¢ <code>1 OR 1=1</code> - Accede a todos los registros<br>
                     ‚Ä¢ <code>1; DROP TABLE usuarios;</code> - Elimina tabla<br>
                     ‚Ä¢ <code>1 UNION SELECT * FROM passwords</code> - Extrae otros datos`;
            }
            
            // VULNERABLE: Debug logs
            console.log('=== DEBUG INFO ===');
            console.log('App: Sistema Bancario Vulnerable v2.0');
            console.log('Build: Semestral Project');
            console.log('Secrets expuestos:', API_SECRETS);
            console.log('Hardcoded credentials:', HARDCODED_CREDENTIALS);
            console.log('Session:', localStorage.getItem('userSession'));
            console.log('==================');
            
            // VULNERABLE: Cookie manipulation
            document.cookie = "session=insecure_session_123; path=/;";
            document.cookie = "user_prefs=theme=dark; path=/;";
        </script>
        
        <footer>
            <hr>
            <h3>üìö Proyecto Semestral - Seguridad en Aplicaciones Web</h3>
            <p><strong>Flujo CI/CD implementado:</strong> GitHub ‚Üí Jenkins ‚Üí SonarQube ‚Üí Despliegue Autom√°tico</p>
            <p><strong>Vulnerabilidades implementadas:</strong> 7 tipos diferentes para an√°lisis de seguridad</p>
            <p><strong>Demostraci√≥n en vivo:</strong> Cada cambio en este c√≥digo activa an√°lisis autom√°tico</p>
            <p>¬© 2024 - Proyecto de An√°lisis de Vulnerabilidades Web</p>
        </footer>
    </div>
</body>
</html>
